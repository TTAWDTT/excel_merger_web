# 🧪 图表实验室快速上手指南

## ✅ 问题已解决

### 1. openpyxl 版本升级
- ✅ 从 2.4.11 升级到 3.1.5
- ✅ 解决了 API 400 错误
- ✅ 满足 pandas 依赖要求

### 2. 页面风格优化
- ✅ 统一卡片式设计
- ✅ 渐变色主题
- ✅ 图标增强
- ✅ 响应式布局
- ✅ 交互动画

## 🚀 立即使用

### 访问地址
```
http://localhost:8000/charts/lab/
或点击导航栏的 "图表实验室"
```

### 快速体验三步骤

#### 📤 步骤 1: 上传测试数据
使用已生成的测试文件：`d:/桌面/excel_work/test_data.xlsx`

**测试数据包含：**
- 5 个城市数据
- 人口和 GDP 两个数值列
- 适合各种图表类型测试

#### ⚙️ 步骤 2: 配置示例图表

**示例 1: 柱状图（推荐新手）**
```
图表类型: 柱状图
X 轴字段: 城市
Y 轴字段: 人口
图表标题: 主要城市人口分布
```

**示例 2: 折线图**
```
图表类型: 折线图
X 轴字段: 城市
Y 轴字段: GDP
图表标题: 城市GDP对比
```

**示例 3: 多指标对比**
```
图表类型: 柱状图
X 轴字段: 城市
Y 轴字段: 人口, GDP (按住 Ctrl 多选)
图表标题: 城市综合数据对比
```

**示例 4: 带过滤条件**
```
图表类型: 柱状图
X 轴字段: 城市
Y 轴字段: GDP
过滤条件: 人口 > 1800
图表标题: 人口超过1800万的城市GDP
```

#### 📊 步骤 3: 查看结果
点击"生成图表"按钮，即可看到：
- 📈 生成的图表图像
- 📋 图表元信息（类型、行数、轴字段）
- 📊 绘图数据统计

## 🎨 页面特点对比

### 🆕 新版本
```
✨ 三个独立卡片式区块
✨ 渐变色标题和图标
✨ 配置项分组清晰
✨ 表格样式专业化
✨ 过滤标签美观实用
✨ 汇总信息渐变背景
✨ 悬停动画效果
```

### 🔄 与其他页面对比
```
✅ 与任务创建页面风格统一
✅ 使用相同的颜色变量
✅ 卡片阴影和圆角一致
✅ 按钮样式统一
✅ 表单布局规范
✅ 图标使用规范
```

## 💡 高级技巧

### 1. 数据聚合
当你需要按某个字段分组统计时：
```
分组字段: 选择要分组的列
聚合方式: 求和/平均值/计数等
Y 轴字段: 选择要聚合的数值列
```

### 2. 多条件过滤
可以添加多个过滤条件：
```
条件 1: 人口 > 1500
条件 2: GDP < 35000
结果: 只显示同时满足两个条件的数据
```

### 3. 图表尺寸调整
根据数据量调整图表大小：
```
数据点少: 8 x 5 英寸
数据点多: 12 x 7 英寸
横向标签长: 增加宽度 + X轴角度 45°
```

### 4. 导出建议
右键点击生成的图表图像 → "图片另存为" 即可保存

## 🎯 使用场景

### 场景 1: 快速数据探索
```
不想创建合并任务，只是想快速看看数据分布
→ 上传文件 → 选择几个字段 → 立即生成图表
```

### 场景 2: 数据对比分析
```
比较多个指标在不同维度下的表现
→ 使用多选 Y 轴字段功能
→ 不同指标自动生成不同颜色的系列
```

### 场景 3: 异常数据筛查
```
找出不符合条件的数据
→ 使用过滤条件功能
→ 快速定位问题数据
```

### 场景 4: 汇报材料准备
```
需要生成专业的数据图表
→ 设置图表标题和轴标签
→ 调整尺寸和样式
→ 保存图表用于 PPT
```

## 🎓 学习路径

### 新手推荐
1. 使用测试数据 → 生成简单柱状图 ✅
2. 尝试不同图表类型 ✅
3. 添加图表标题和标签 ✅

### 进阶使用
1. 使用数据聚合功能
2. 组合多个过滤条件
3. 调整图表样式细节

### 高级应用
1. 处理大型数据集
2. 复杂数据分析
3. 批量生成系列图表

## ⚡ 性能提示

### 数据量建议
```
✅ 推荐: 5-10万行以内
⚠️ 注意: 10-50万行（可能较慢）
❌ 避免: 超过50万行（建议先筛选）
```

### 图表类型性能
```
快速: 柱状图、折线图、饼图
中等: 散点图、面积图
较慢: 箱线图（大数据量）
```

## 🔍 常见问题

### Q1: 为什么生成按钮是灰色的？
A: 需要先上传文件并生成数据预览

### Q2: 散点图提示只能选一个Y轴？
A: 是的，散点图特性要求单个Y轴字段

### Q3: 过滤条件不生效？
A: 检查字段名和值是否正确，数值类型不要加引号

### Q4: 图表显示不完整？
A: 增加图表宽度或调整X轴刻度角度

### Q5: 如何删除过滤条件？
A: 点击过滤标签右侧的 ✕ 按钮

## 📸 截图说明

### 页面布局
```
┌─────────────────────────────────┐
│  📤 步骤1: 数据上传与预览         │
│  [文件选择] [工作表] [预览行数]   │
│  [生成预览按钮]                  │
│  ─────────────────────────────   │
│  📊 数据汇总 + 表格预览           │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│  ⚙️ 步骤2: 图表配置              │
│  ┌─ 基本设置 ─────────────┐     │
│  │ 图表类型 X轴 Y轴         │     │
│  └─────────────────────────┘     │
│  ┌─ 数据聚合(可选) ────────┐     │
│  │ 分组字段 聚合方式        │     │
│  └─────────────────────────┘     │
│  ┌─ 样式设置 ─────────────┐     │
│  │ 标题 尺寸 角度等         │     │
│  └─────────────────────────┘     │
│  ┌─ 过滤条件(可选) ────────┐     │
│  │ [过滤标签列表]           │     │
│  └─────────────────────────┘     │
│  [生成图表按钮]                  │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│  📈 步骤3: 图表结果              │
│  [图表图像]                      │
│  ─────────────────────────────   │
│  📊 图表信息汇总                 │
└─────────────────────────────────┘
```

## 🎉 开始使用

1. **启动服务器** (已启动)
   ```
   python manage.py runserver
   ```

2. **打开浏览器**
   ```
   http://localhost:8000/charts/lab/
   ```

3. **上传测试文件**
   ```
   d:/桌面/excel_work/test_data.xlsx
   ```

4. **享受数据可视化！** 🎊

---

💡 **提示**: 详细文档请查看 `CHART_LAB_UPDATE.md`
