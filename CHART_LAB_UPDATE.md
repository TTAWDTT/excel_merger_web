# å›¾è¡¨å®éªŒå®¤æ›´æ–°è¯´æ˜

## ğŸ‰ æ›´æ–°å†…å®¹

### 1. ä¾èµ–é—®é¢˜ä¿®å¤
- **é—®é¢˜**: `openpyxl` ç‰ˆæœ¬ 2.4.11 ä¸æ»¡è¶³ pandas è¦æ±‚ (éœ€è¦ â‰¥3.1.0)
- **è§£å†³**: å‡çº§ `openpyxl` åˆ° 3.1.5
- **å½±å“**: è§£å†³äº† `/api/charts/inspect/` è¿”å› 400 é”™è¯¯çš„é—®é¢˜

### 2. é¡µé¢é£æ ¼ä¼˜åŒ–
å®Œå…¨é‡æ„å›¾è¡¨å®éªŒå®¤é¡µé¢ï¼Œä½¿å…¶ä¸å…¶ä»–é¡µé¢é£æ ¼ä¿æŒä¸€è‡´ï¼š

#### è§†è§‰è®¾è®¡ä¼˜åŒ–
- âœ¨ é‡‡ç”¨å¡ç‰‡å¼å¸ƒå±€ï¼Œä¸ä»»åŠ¡åˆ›å»ºé¡µé¢é£æ ¼ç»Ÿä¸€
- ğŸ¨ ä½¿ç”¨æ¸å˜è‰²æ ‡é¢˜å’Œå›¾æ ‡ï¼Œå¢å¼ºè§†è§‰å±‚æ¬¡
- ğŸ“¦ æ·»åŠ åˆ†ç»„é…ç½®åŒºå—ï¼Œæå‡å†…å®¹ç»„ç»‡æ€§
- ğŸ¯ ä¼˜åŒ–è¡¨æ ¼æ ·å¼ï¼Œè¡¨å¤´ä½¿ç”¨ä¸»é¢˜è‰²é«˜äº®
- ğŸ’« æ·»åŠ æ‚¬åœåŠ¨ç”»æ•ˆæœï¼Œæå‡äº¤äº’ä½“éªŒ

#### å¸ƒå±€æ”¹è¿›
- ğŸ“‹ é‡‡ç”¨ä¸‰æ­¥éª¤æµç¨‹ï¼šä¸Šä¼ é¢„è§ˆ â†’ é…ç½® â†’ ç»“æœ
- ğŸ”² ä½¿ç”¨ `section-header` ç»Ÿä¸€å„åŒºå—æ ‡é¢˜æ ·å¼
- ğŸ“Š é…ç½®é¡¹æŒ‰åŠŸèƒ½åˆ†ç»„ï¼šåŸºæœ¬è®¾ç½®ã€æ•°æ®èšåˆã€æ ·å¼è®¾ç½®ã€è¿‡æ»¤æ¡ä»¶
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œé€‚é…ç§»åŠ¨ç«¯æ˜¾ç¤º

#### äº¤äº’å¢å¼º
- ğŸ·ï¸ è¿‡æ»¤æ¡ä»¶æ ‡ç­¾æ·»åŠ å›¾æ ‡å’Œåˆ é™¤æŒ‰é’®
- ğŸ“ˆ ç»Ÿè®¡å¡ç‰‡æ·»åŠ æ¸å˜èƒŒæ™¯å’Œå›¾æ ‡
- âš ï¸ è­¦å‘Šæç¤ºæ¡†ä¼˜åŒ–å¸ƒå±€å’Œå›¾æ ‡æ˜¾ç¤º
- ğŸ¨ æ±‡æ€»ä¿¡æ¯æ é‡‡ç”¨æ¸å˜è‰²èƒŒæ™¯

#### åŠŸèƒ½ç»†èŠ‚
- è¡¨å•æ ‡ç­¾æ·»åŠ å›¾æ ‡ï¼Œæå‡å¯è¯»æ€§
- å¤šé€‰æ¡†æ·»åŠ æç¤ºæ–‡å­—
- ç©ºçŠ¶æ€æç¤ºä¼˜åŒ–ï¼Œä½¿ç”¨å¤§å›¾æ ‡å’Œè¯´æ˜æ–‡å­—
- æŒ‰é’®åˆ†ç»„å’Œé—´è·è°ƒæ•´

### 3. JavaScript ä¼˜åŒ–
æ›´æ–°å‰ç«¯äº¤äº’é€»è¾‘ä»¥åŒ¹é…æ–°çš„ HTML ç»“æ„ï¼š

```javascript
// æ›´æ–°å†…å®¹ï¼š
- renderFilters(): æ·»åŠ å›¾æ ‡å’Œä¼˜åŒ–ç©ºçŠ¶æ€æç¤º
- updateSummary(): æ±‡æ€»ä¿¡æ¯æ·»åŠ å›¾æ ‡
- renderStatistics(): ç»Ÿè®¡å¡ç‰‡æ ·å¼ä¼˜åŒ–
- showWarnings(): è­¦å‘Šä¿¡æ¯å¸ƒå±€æ”¹è¿›
- renderChartResult(): å›¾è¡¨ç»“æœå±•ç¤ºä¼˜åŒ–
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### è®¿é—®å…¥å£
- å¯¼èˆªæ ç‚¹å‡» **å›¾è¡¨å®éªŒå®¤** æˆ–ç›´æ¥è®¿é—® `/charts/lab/`

### æ“ä½œæµç¨‹

#### æ­¥éª¤ 1: æ•°æ®ä¸Šä¼ ä¸é¢„è§ˆ
1. é€‰æ‹© Excel/CSV/JSON æ–‡ä»¶
2. å¯é€‰ï¼šæŒ‡å®šå·¥ä½œè¡¨åç§°ï¼ˆExcelï¼‰
3. è®¾ç½®é¢„è§ˆè¡Œæ•°ï¼ˆ5-200ï¼‰
4. ç‚¹å‡»"ç”Ÿæˆæ•°æ®é¢„è§ˆ"

**é¢„è§ˆå†…å®¹ï¼š**
- æ•°æ®æ±‡æ€»ï¼šæ€»è¡Œæ•°ã€åˆ—æ•°é‡ã€æ•°å€¼åˆ—æ•°
- æ•°æ®è¡¨æ ¼ï¼šå‰ N è¡Œæ•°æ®
- åŸºç¡€ç»Ÿè®¡ï¼šæ•°å€¼åˆ—çš„æè¿°æ€§ç»Ÿè®¡

#### æ­¥éª¤ 2: å›¾è¡¨é…ç½®

**åŸºæœ¬è®¾ç½®ï¼š**
- å›¾è¡¨ç±»å‹ï¼šæŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€æ•£ç‚¹å›¾ç­‰
- X è½´å­—æ®µï¼šé€‰æ‹©æ¨ªè½´æ•°æ®
- Y è½´å­—æ®µï¼šé€‰æ‹©çºµè½´æ•°æ®ï¼ˆå¯å¤šé€‰ï¼‰

**æ•°æ®èšåˆï¼ˆå¯é€‰ï¼‰ï¼š**
- åˆ†ç»„å­—æ®µï¼šæŒ‰æŸäº›åˆ—åˆ†ç»„ï¼ˆå¯å¤šé€‰ï¼‰
- èšåˆæ–¹å¼ï¼šæ±‚å’Œã€å¹³å‡å€¼ã€è®¡æ•°ç­‰

**æ ·å¼è®¾ç½®ï¼š**
- å›¾è¡¨æ ‡é¢˜ã€X/Y è½´åç§°
- å›¾è¡¨å°ºå¯¸ï¼ˆå®½åº¦ã€é«˜åº¦ï¼‰
- X è½´åˆ»åº¦è§’åº¦
- æ˜¾ç¤ºç½‘æ ¼ã€æ˜¾ç¤ºå›¾ä¾‹

**æ•°æ®è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰ï¼š**
- é€‰æ‹©å­—æ®µã€æ¡ä»¶å’Œå€¼
- æ”¯æŒå¤šä¸ªè¿‡æ»¤æ¡ä»¶å åŠ 
- ç‚¹å‡»æ ‡ç­¾ä¸Šçš„ âœ• åˆ é™¤æ¡ä»¶

#### æ­¥éª¤ 3: ç”Ÿæˆä¸æŸ¥çœ‹
1. ç‚¹å‡»"ç”Ÿæˆå›¾è¡¨"æŒ‰é’®
2. ç­‰å¾…å›¾è¡¨æ¸²æŸ“ï¼ˆæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
3. æŸ¥çœ‹ç”Ÿæˆçš„å›¾è¡¨å’Œç»Ÿè®¡ä¿¡æ¯

## ğŸ“Š æµ‹è¯•æ•°æ®

å·²åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼š`d:/æ¡Œé¢/excel_work/test_data.xlsx`

**æµ‹è¯•æ•°æ®å†…å®¹ï¼š**
```
åŸå¸‚    äººå£(ä¸‡)  GDP(äº¿å…ƒ)
åŒ—äº¬    2154     40269
ä¸Šæµ·    2428     43214
å¹¿å·    1868     28231
æ·±åœ³    1756     30665
æ­å·    1220     18753
```

## ğŸ¨ æ ·å¼ç‰¹ç‚¹

### é…è‰²æ–¹æ¡ˆ
- ä¸»è‰²è°ƒï¼šä½¿ç”¨é¡¹ç›®ç»Ÿä¸€çš„ `--primary-color` å’Œ `--primary-light`
- å¡ç‰‡èƒŒæ™¯ï¼š`--card-bg` (æ”¯æŒæ·±è‰²æ¨¡å¼)
- æ¸å˜æ•ˆæœï¼šç»Ÿä¸€ä½¿ç”¨ 135deg çº¿æ€§æ¸å˜

### ç»„ä»¶æ ·å¼
- **section-header**: åŒºå—æ ‡é¢˜ï¼Œå¸¦å›¾æ ‡å’Œæ¸å˜è‰²
- **config-section**: é…ç½®åŒºå—ï¼Œæµ…è‰²èƒŒæ™¯åŒºåˆ†
- **summary-bar**: æ±‡æ€»ä¿¡æ¯æ ï¼Œæ¸å˜èƒŒæ™¯
- **filter-badge**: è¿‡æ»¤æ ‡ç­¾ï¼Œä¸»é¢˜è‰²èƒŒæ™¯
- **stat-card**: ç»Ÿè®¡å¡ç‰‡ï¼Œæ‚¬åœæ•ˆæœ

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‰ç«¯æŠ€æœ¯æ ˆ
- HTML5 + Django Templates
- CSS3 (å˜é‡ã€æ¸å˜ã€åŠ¨ç”»)
- JavaScript (ES6+)
- Font Awesome å›¾æ ‡

### åç«¯ API
- `/api/charts/inspect/`: æ•°æ®é¢„è§ˆæ¥å£
- `/api/charts/custom/`: å›¾è¡¨ç”Ÿæˆæ¥å£

### ä¾èµ–åº“
- pandas >= 2.0.0
- numpy >= 1.24.0
- matplotlib >= 3.7.0
- openpyxl >= 3.1.0

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶å¤§å°é™åˆ¶**: é¢„è§ˆæœ€å¤š 50,000 è¡Œæ•°æ®
2. **å›¾è¡¨ç±»å‹é™åˆ¶**:
   - æ•£ç‚¹å›¾ï¼šåªæ”¯æŒå•ä¸ª Y è½´å­—æ®µ
   - é¥¼å›¾ï¼šåªæ”¯æŒå•ä¸ªæ•°å€¼å­—æ®µ
3. **æ•°æ®èšåˆ**: é€‰æ‹©åˆ†ç»„å­—æ®µåï¼ŒY è½´æ•°æ®ä¼šè‡ªåŠ¨èšåˆ
4. **è¿‡æ»¤æ¡ä»¶**: ä½¿ç”¨ `in` æˆ– `not_in` æ—¶ï¼Œå¤šä¸ªå€¼ç”¨é€—å·åˆ†éš”

## ğŸ› é—®é¢˜æ’æŸ¥

### å¦‚æœé¡µé¢æ— æ³•åŠ è½½
```bash
# æ£€æŸ¥æ¨¡æ¿è¯­æ³•
python manage.py shell -c "from django.test import Client; c=Client(); r=c.get('/charts/lab/', HTTP_HOST='localhost'); print(r.status_code)"
```

### å¦‚æœ API è¿”å› 400
```bash
# æ£€æŸ¥ openpyxl ç‰ˆæœ¬
python -c "import openpyxl; print(openpyxl.__version__)"

# åº”è¯¥æ˜¾ç¤º >= 3.1.0
```

### å¦‚æœæ ·å¼æ˜¾ç¤ºå¼‚å¸¸
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. æ£€æŸ¥ `{% load static %}` æ˜¯å¦å­˜åœ¨
3. ç¡®è®¤ CSS å˜é‡å·²å®šä¹‰ï¼ˆåœ¨ base.html ä¸­ï¼‰

## ğŸ¯ ä¸‹ä¸€æ­¥ä¼˜åŒ–å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–**
   - å¤§æ–‡ä»¶å¼‚æ­¥å¤„ç†
   - å›¾è¡¨ç¼“å­˜æœºåˆ¶
   - è¿›åº¦æ¡æ˜¾ç¤º

2. **åŠŸèƒ½å¢å¼º**
   - æ”¯æŒæ›´å¤šå›¾è¡¨ç±»å‹ï¼ˆçƒ­åŠ›å›¾ã€é›·è¾¾å›¾ç­‰ï¼‰
   - å›¾è¡¨å¯¼å‡ºåŠŸèƒ½ï¼ˆPNGã€SVGã€PDFï¼‰
   - é…ç½®ä¿å­˜å’ŒåŠ è½½
   - å›¾è¡¨å¯¹æ¯”åŠŸèƒ½

3. **ç”¨æˆ·ä½“éªŒ**
   - æ‹–æ‹½ä¸Šä¼ ä¼˜åŒ–
   - é…ç½®é¢„è®¾æ¨¡æ¿
   - å®æ—¶é¢„è§ˆåŠŸèƒ½
   - ç§»åŠ¨ç«¯æ‰‹åŠ¿æ”¯æŒ

## ğŸ“š ç›¸å…³æ–‡ä»¶

- æ¨¡æ¿: `merger/templates/merger/chart_lab.html`
- æ ·å¼: å†…è”åœ¨æ¨¡æ¿çš„ `extra_css` å—ä¸­
- è„šæœ¬: `merger/static/js/chart_lab.js`
- è§†å›¾: `merger/views.py` (chart_lab, api_custom_chart_inspect, api_generate_custom_chart)
- è·¯ç”±: `merger/urls.py`
- ä¾èµ–: `requirements.txt`

---

**æ›´æ–°æ—¥æœŸ**: 2025å¹´10æœˆ20æ—¥  
**ç‰ˆæœ¬**: v3.1  
**ä½œè€…**: GitHub Copilot
