# 🚀 快速测试指南

## 立即测试修复的功能

访问: **http://127.0.0.1:8000/**

---

## 测试1: 列派生修复 (5分钟)

### 准备测试数据
创建一个Excel文件 `test_students.xlsx`:
```
学号
202401001
202401002
202402001
202402002
202403001
```

### 测试场景1: 只提取不映射
```
1. 访问 http://127.0.0.1:8000/tasks/create/
2. 任务名称: "测试列派生-只提取"
3. 点击"下一步"
4. 上传 test_students.xlsx
5. 点击"下一步"
6. ☑ 启用列派生
   - 源列名: 学号
   - 新列名: 年份
   - ☑ 启用子串提取
     * 起始位置: 1
     * 结束位置: 4
   - 映射规则: 不添加
7. 点击"下一步"→"下一步"→"开始处理"
8. 下载结果文件
9. 验证: "年份"列应该显示 "2024" ✓
```

### 测试场景2: 提取后映射
```
1. 创建新任务: "测试列派生-映射"
2. 上传 test_students.xlsx
3. ☑ 启用列派生
   - 源列名: 学号
   - 新列名: 班级
   - ☑ 启用子串提取
     * 起始位置: 5
     * 结束位置: 6
   - 映射规则:
     * 点击"+ 添加映射"
       - 模式: 01
       - 值: 一班
     * 再次点击"+ 添加映射"
       - 模式: 02
       - 值: 二班
     * 再次点击"+ 添加映射"
       - 模式: 03
       - 值: 三班
4. 处理并下载
5. 验证: "班级"列显示 "一班"、"二班"、"三班" ✓
```

---

## 测试2: 键盘快捷键 (3分钟)

### 测试映射规则输入
```
1. 创建新任务,进入列规则步骤
2. ☑ 启用列派生
3. 点击"+ 添加映射"
4. 输入 "01"
5. 按 Tab 键 → 光标应该移动到"值"输入框 ✓
6. 输入 "一班"
7. 按 Tab 键 → 应该自动创建新行 ✓
8. 输入 "02"
9. 按 Enter 键 → 光标应该移动到"值"输入框 ✓
10. 输入 "二班"
11. 按 Enter 键 → 应该自动创建新行 ✓
12. 在新行按 Ctrl+Delete → 应该删除当前空行 ✓
```

### 测试单元格操作输入
```
1. 进入单元格操作步骤
2. 点击"+ 添加操作"
3. 输入 "成绩"
4. 按 Enter 键 → 移动到操作下拉框 ✓
5. 选择 "添加后缀"
6. 按 Enter 键 → 移动到值输入框 ✓
7. 输入 "分"
8. 按 Enter 键 → 自动创建新行 ✓
```

---

## 测试3: 列过滤功能 (5分钟)

### 准备测试数据
创建 `test_full.xlsx`:
```
学号       | 姓名   | 性别 | 成绩 | 备注
202401001  | 张三   | 男   | 85   | 优秀
202401002  | 李四   | 女   | 90   | 优秀
202402001  | 王五   | 男   | 78   | 良好
```

### 测试场景1: 只保留指定列
```
1. 创建新任务: "测试列过滤-保留"
2. 基本信息:
   - 列过滤模式: 只保留指定列
   - 列名列表:
     学号
     姓名
     成绩
3. 上传 test_full.xlsx
4. 处理并下载
5. 验证: 结果只有3列(学号、姓名、成绩) ✓
6. 验证: 没有"性别"和"备注"列 ✓
```

### 测试场景2: 删除指定列
```
1. 创建新任务: "测试列过滤-删除"
2. 基本信息:
   - 列过滤模式: 删除指定列
   - 列名列表:
     性别
     备注
3. 上传 test_full.xlsx
4. 处理并下载
5. 验证: 没有"性别"和"备注"列 ✓
6. 验证: 有"学号"、"姓名"、"成绩"列 ✓
```

---

## 测试4: 组合功能 (10分钟)

### 完整工作流程测试
```
任务: 从学号提取班级,删除学号列,给成绩加单位

1. 创建任务: "组合功能测试"
2. 基本信息:
   - 列过滤模式: 删除指定列
   - 列名列表:
     学号
     备注
3. 上传 test_full.xlsx
4. 列派生:
   ☑ 启用列派生
   - 源列名: 学号
   - 新列名: 班级
   - ☑ 启用子串提取
     * 起始位置: 5
     * 结束位置: 6
   - 映射规则:
     * 01 → 一班
     * 02 → 二班
5. 单元格操作:
   + 添加操作
   - 列名: 成绩
   - 操作: 添加后缀
   - 值: 分
6. 处理并下载
7. 验证结果:
   ✓ 有"班级"列,显示"一班"、"二班"
   ✓ 没有"学号"列
   ✓ 没有"备注"列
   ✓ "成绩"列显示 "85分"、"90分"、"78分"
   ✓ 有"姓名"、"性别"列
```

---

## ✅ 验证清单

### 列派生功能
- [ ] 只提取不映射时,新列有值
- [ ] 提取后映射时,匹配的显示映射值
- [ ] 提取后映射不匹配时,显示提取值
- [ ] 没有提取直接映射时工作正常

### 键盘操作
- [ ] Tab键移动到下一个字段
- [ ] 最后一个字段Tab自动创建新行
- [ ] Enter键在映射规则中移动正确
- [ ] Enter键在单元格操作中移动正确
- [ ] Ctrl+Delete删除当前行
- [ ] 新行自动聚焦

### 列过滤
- [ ] "只保留指定列"模式工作正常
- [ ] "删除指定列"模式工作正常
- [ ] 列名不存在时不报错
- [ ] 在任务详情中显示过滤配置
- [ ] 过滤在正确的时机执行(最后)

### 组合功能
- [ ] 列派生+列过滤
- [ ] 列派生+单元格操作
- [ ] 列过滤+单元格操作
- [ ] 三个功能全部启用

---

## 🐛 如果遇到问题

### 列派生还是空列?
```
1. 检查源列名是否正确(区分大小写)
2. 检查提取位置是否正确
3. 查看任务详情的错误信息
4. 在浏览器控制台查看是否有错误
```

### 列过滤没生效?
```
1. 确认在基本信息步骤配置了过滤模式
2. 确认列名列表格式正确(每行一个)
3. 确认列名与Excel中完全一致
4. 查看任务详情,确认过滤配置已保存
```

### 键盘快捷键不工作?
```
1. 刷新页面(可能缓存了旧代码)
2. 确认在正确的输入框中按快捷键
3. 检查浏览器控制台是否有JavaScript错误
```

---

## 📊 测试结果记录

完成测试后,请记录:

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 列派生-只提取 | [ ] | [ ] | |
| 列派生-映射匹配 | [ ] | [ ] | |
| 列派生-映射不匹配 | [ ] | [ ] | |
| 键盘-映射规则 | [ ] | [ ] | |
| 键盘-单元格操作 | [ ] | [ ] | |
| 列过滤-保留 | [ ] | [ ] | |
| 列过滤-删除 | [ ] | [ ] | |
| 组合功能 | [ ] | [ ] | |

---

## 📞 需要帮助?

- 详细文档: `BUG_FIXES.md`
- 功能说明: `FEATURE_UPDATE.md`
- 快速演示: `QUICK_DEMO.md`

---

**预计测试时间: 20-30分钟**  
**当前服务器状态: ✅ 运行中**  
**测试地址: http://127.0.0.1:8000/**

开始测试吧! 🚀
